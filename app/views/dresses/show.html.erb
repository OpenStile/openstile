<% provide(:title, @dress.name) %>

<%= render "shared/header" %>

<div class="recommendation-details block">
  <div class="container">
    <div class="row">
      <div class="col-md-offset-1 col-md-5 col-xs-offset-1 col-xs-5">
        <img class="img-responsive" src="http://placehold.it/400x500">
      </div>
      <div class="col-md-5 col-xs-5 text-center">
        <hr>
        <h1><%= @dress.name %></h1><br />
        <h2><%= "$%6.2f" % @dress.price.to_f %></h2><br />
        <h2><%= link_to @dress.retailer.name, 
                        retailer_path(@dress.retailer) %></h2><br />
        <h4><%= @dress.description %></h4>
        <hr>
        <p><%= link_to("View in online store", @dress.web_link, target: '_blank') unless @dress.web_link.blank? %></p>
      </div>
    </div>

    <% if shopper_signed_in? %>
      <% existing_drop_in = DropIn.upcoming_for_shopper_at_retailer(current_shopper.id, @dress.retailer.id).first %>
      <% if existing_drop_in.nil? %>
        <%= render 'shared/schedule_drop_in', retailer: @dress.retailer,
                                              for_retailer: false,
                                              item: @dress %>
      <% else %>
        <%= render 'shared/update_existing_drop_in', retailer: @dress.retailer,
                                                     drop_in: existing_drop_in,
                                                     item: @dress %>
      <% end %>
    <% end %>
  </div>
</div>

